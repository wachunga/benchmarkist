<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Transact</title>
	<link rel="stylesheet" href="main.css">
</head>
<body>
	<nav class="main-nav">
		<div>Bench Test</div>
	</nav>
	<div class="container">
		<h1>Transactions</h1>
		<table class="sum-table">
			<thead>
			<th>Date</th>
			<th>Company</th>
			<th>Account</th>
			<th><!-- dynamic content --></th>
			</thead>
			<tbody>
				<tr>
					<td colspan="4">Loading...</td>
				</tr>
			</tbody>
		</table>
	</div>

<script>
	const tableBodyNode = document.querySelector('.sum-table tbody');
	if (!fetch) {
		alert('Your browser is currently unsupported');
	}

	fetchTransactions().then(function (result) {
		addResults(result.transactions);
	});

	function fetchTransactions() {
		return fetch('/a/1/transactions?formatted=true')
			.then(function (response) {
				return response.json();
			});
	}

	function addResults(results) {
		tableBodyNode.innerHTML = results.map(result => {
			const rowClass = result.Ledger === '' ? ' class="income-row"' : '';
			return `
<tr${rowClass}>
	<td>${result.Date}</td>
	<td>${result.Company}</td>
	<td>${result.Ledger}</td>
	<td>${result.Amount}</td>
</tr>`;
		}).join('\n');
	}
</script>
</body>
</html>
